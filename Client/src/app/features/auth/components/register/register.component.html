<div class="flex justify-center items-center min-h-screen bg-gray-100">
  <mat-card class="w-full max-w-md p-6 shadow-lg">
    <mat-card-header class="flex justify-center mb-6">
      <mat-card-title class="text-2xl font-bold text-primary">Register</mat-card-title>
    </mat-card-header>
    
    <mat-card-content>
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="flex flex-col gap-4">
        @if (error) {
          <mat-error class="mb-4">{{error}}</mat-error>
        }
        
        <mat-horizontal-stepper [linear]="true" #stepper [selectedIndex]="currentStep">
          <!-- Step 1: Basic Information -->
          <mat-step [stepControl]="registerForm" label="Account Details">
            <div class="flex flex-col gap-4 py-4">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Username</mat-label>
                <input matInput formControlName="username" type="text" required>
                <mat-error *ngIf="submitted && f['username'].errors?.['required']">
                  Username is required
                </mat-error>
                <mat-error *ngIf="submitted && f['username'].errors?.['minlength']">
                  Username must be at least 3 characters
                </mat-error>
                <mat-error *ngIf="submitted && f['username'].errors?.['maxlength']">
                  Username cannot exceed 20 characters
                </mat-error>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Email</mat-label>
                <input matInput formControlName="email" type="email" required>
                <mat-error *ngIf="submitted && f['email'].errors?.['required']">
                  Email is required
                </mat-error>
                <mat-error *ngIf="submitted && f['email'].errors?.['email']">
                  Please enter a valid email address
                </mat-error>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Password</mat-label>
                <input matInput formControlName="password" type="password" required>
                <mat-error *ngIf="submitted && f['password'].errors?.['required']">
                  Password is required
                </mat-error>
                <mat-error *ngIf="submitted && f['password'].errors?.['minlength']">
                  Password must be at least 6 characters
                </mat-error>
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Confirm Password</mat-label>
                <input matInput formControlName="confirmPassword" type="password" required>
                <mat-error *ngIf="submitted && f['confirmPassword'].errors?.['required']">
                  Please confirm your password
                </mat-error>
                <mat-error *ngIf="submitted && f['confirmPassword'].errors?.['passwordMismatch']">
                  Passwords do not match
                </mat-error>
              </mat-form-field>
              
              <div class="flex justify-end">
                <button 
                  mat-raised-button 
                  color="primary" 
                  type="button" 
                  (click)="nextStep()"
                  [disabled]="f['username'].invalid || f['email'].invalid || f['password'].invalid || f['confirmPassword'].invalid">
                  Next
                </button>
              </div>
            </div>
          </mat-step>
          
          <!-- Step 2: Profile Information -->
          <mat-step [stepControl]="registerForm" label="Profile Details">
            <div class="flex flex-col gap-4 py-4">
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Display Name (Optional)</mat-label>
                <input matInput formControlName="displayName" type="text">
              </mat-form-field>
              
              <mat-form-field appearance="outline" class="w-full">
                <mat-label>Bio (Optional)</mat-label>
                <textarea matInput formControlName="bio" rows="3"></textarea>
              </mat-form-field>
              
              <div class="mb-4">
                <mat-checkbox formControlName="agreeToTerms" color="primary" required>
                  I agree to the Terms of Service and Privacy Policy
                </mat-checkbox>
                <mat-error *ngIf="submitted && f['agreeToTerms'].errors?.['required']" class="mt-1">
                  You must agree to the terms to continue
                </mat-error>
              </div>
              
              <div class="flex justify-between">
                <button 
                  mat-button 
                  type="button" 
                  (click)="prevStep()">
                  Back
                </button>
                
                <button 
                  mat-raised-button 
                  color="primary" 
                  type="submit" 
                  [disabled]="loading || !f['agreeToTerms'].value">
                  @if (loading) {
                    <mat-spinner diameter="20" class="mr-2"></mat-spinner>
                  }
                  Register
                </button>
              </div>
            </div>
          </mat-step>
        </mat-horizontal-stepper>
        
        <div class="text-center mt-4">
          Already have an account?
          <a routerLink="/auth/login" class="text-primary hover:underline ml-1">
            Login
          </a>
        </div>
      </form>
    </mat-card-content>
  </mat-card>
</div>
